name: Trigger Ceremony

on:
  push:
  # Updates to the \audit branch can only be made through the submission and successful merging of a pull request
    branches: [ audit ]


jobs:

  trigger:
    runs-on: ubuntu-22.04
    
    steps:

      - name: Trigger
        run: |
          curl -X GET https://ceremony.appliedzkp.org/create
          echo "Ceremony is triggered"


          # When server received a request via https://ceremony.appliedzkp.org/create,
          it will use \audit branch to proceed ceremony

      - name: Verify Ceremony was set up correctly
        run: |
          curl -X GET https://ceremony.appliedzkp.org/maci > ceremony_info.json

          ./scripts/verifyCeremony.sh ceremony_info.json
          echo "Ceremony verification complete"
